CREATE TABLE Usuario (
    id INT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR(50),
    endereco VARCHAR(100),
    consumoMensal INT,
    producaoMensal INT
);

CREATE TABLE Microrede (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nome VARCHAR(100),
    total_produzido DECIMAL(10, 2),
    total_consumido DECIMAL(10, 2),
    energia_armazenada DECIMAL(10, 2)
);


ALTER TABLE Usuario
ADD microrede_id INT;

ALTER TABLE Usuario
ADD CONSTRAINT fk_microrede
    FOREIGN KEY (microrede_id)
    REFERENCES Microrede(id)
    ON DELETE SET NULL;
    
ALTER TABLE Usuario MODIFY (microrede_id NULL);

CREATE TABLE Credito (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY, 
    saldo NUMBER(10, 2) NOT NULL,  
    usuario_id NUMBER, 
    data_ultimo_update DATE DEFAULT SYSDATE,  -- Data do último update
    CONSTRAINT fk_usuario FOREIGN KEY (usuario_id) REFERENCES Usuario(id)
);

CREATE TABLE Relatorio (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  
    nome_relatorio VARCHAR(100),  
    data_geracao DATE DEFAULT SYSDATE,  
    conteudo CLOB  
);




